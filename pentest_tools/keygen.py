"""
Key pair generation for asymmetric encryption
"""
from Crypto import Random
from Crypto.PublicKey import RSA
import sys


def generate_keys(modulus_length=None):
    # RSA modulus length must be a multiple of 256 and >= 1024
    if not modulus_length:
        modulus_length = int(input('Enter modulus length (big value, multiple of 256, preferably bigger than 1024): '))

    privatekey = RSA.generate(modulus_length, Random.new().read)
    publickey = privatekey.publickey()

    return privatekey, publickey


def main(mod_length):
    pub, priv = generate_keys(mod_length)

    with open('pub_key.der', 'wb') as pub_f:
        pub_f.write(pub.exportKey())

    with open('priv_key.der', 'wb') as priv_f:
        priv_f.write(priv.exportKey())

    return None


if __name__ == "__main__":
    main(sys.argv)
    exit(0)
